// netlify/functions/guardarRegistro.js

exports.handler = async (event) => {
  if (event.httpMethod !== "POST") {
    return {
      statusCode: 405,
      body: "Method not allowed",
    };
  }

  try {
    const body = JSON.parse(event.body || "{}");

    // Aquí tienes todos los datos:
    // body.fileName
    // body.pdfBase64
    // body.cliente
    // body.numeroEquipo
    // body.fecha
    // body.ubicacion
    // body.km
    // body.horasGenerales
    // body.horasEspecificas
    // body.detalles

    console.log("Nuevo registro recibido:", body.cliente, body.numeroEquipo);

    // TODO: aquí puedes:
    //  - enviar un correo (con nodemailer)
    //  - guardar en una BD (Supabase/Firebase)
    //  - escribir en Google Sheets, etc.

    return {
      statusCode: 200,
      body: JSON.stringify({ ok: true }),
    };
  } catch (err) {
    console.error("Error en guardarRegistro:", err);
    return {
      statusCode: 500,
      body: JSON.stringify({ error: "Error procesando el registro" }),
    };
  }
};
